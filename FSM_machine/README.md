# Машина состояний FSM на примере бота для заполнения анкеты

Проект представляет собой Telegram-бота, способного собирать данные о пользователе, заполнившего анкету.

## Запуск проекта

1. Установите все зависимости, необходимые для проекта, выполнив команду:
   ```
   pip install -r requirements.txt
   ```

2. Укажите ваш токен API Telegram в переменной окружения BOT_TOKEN.

3. Для запуска бота выполните команду:
   ```
   python main.py
   ```

## Описание файлов и папок

- main.py: Главный файл, содержащий основной код для работы Telegram-бота.
- requirements.txt: Файл, содержащий список зависимостей проекта.
- README.md: Readme-файл с описанием проекта.

## Взаимодействие с ботом

1. Для начала взаимодействия с ботом отправьте команду /start.

2. Чтобы перейти к заполнению анкеты, отправьте команду /fillform.

3. Следуйте инструкциям бота для ввода данных в каждую соответствующую форму.

## Управление состояниями

Проект использует машину состояний (FSM) для управления процессом заполнения анкеты. Каждое состояние сохраняет данные пользователя и переводит бота в следующее состояние для ввода следующей информации.

```

В файле README.md приведено описание проекта, его цели, инструкции по запуску, 
взаимодействию с ботом и управлению состояниями. Это поможет пользователям понять, 
что делает бот и как им пользоваться.

Хэндлеры в коде выполняют следующие действия:

1. process_photo_sent: Хэндлер срабатывает, когда отправляется фотография пользователем.
Он сохраняет информацию о фотографии (файловый идентификатор и идентификатор файла) 
в хранилище данных FSM. Затем создаются объекты инлайн-кнопок для выбора образования 
и создается инлайн-клавиатура. Пользователю отправляется сообщение с клавиатурой, 
а состояние FSM меняется на fill_education.

2. warning_not_photo: Хэндлер срабатывает, если пользователь вводит что-то некорректное 
во время отправки фотографии. Он отправляет сообщение пользователю с просьбой отправить 
фото или прервать заполнение анкеты.

3. process_education_press: Хэндлер срабатывает, когда пользователь выбирает образование 
из клавиатуры. Он сохраняет выбор образования в хранилище данных FSM. Затем создаются 
объекты инлайн-кнопок для выбора желания получать новости и создается инлайн-клавиатура. 
Предыдущее сообщение редактируется с новым текстом и клавиатурой, а состояние FSM меняется
на fill_wish_news.

4. warning_not_education: Хэндлер срабатывает, если пользователь вводит что-то некорректное
во время выбора образования. Он отправляет пользователю сообщение с просьбой использовать 
кнопки для выбора образования или прервать заполнение анкеты.

Обратите внимание, что в коде для работы этих хендлеров используется пакет aiogram, 
который предоставляет удобные инструменты для создания телеграм-ботов на языке Python.

Данные фрагменты кода представляют собой пример обработчиков событий (handlers) 
в фреймворке python-telegram-bot для работы с состояниями (FSM - finite-state machine).

1. warning_not_name: Этот обработчик срабатывает, если вводимое имя является некорректным.
Он отправляет сообщение пользователю с просьбой ввести корректное имя или отправить команду 
/cancel для прерывания процесса заполнения формы.
2. process_age_sent: Этот обработчик срабатывает, если введенный возраст является корректным 
(число от 4 до 120). Он сохраняет возраст в хранилище состояния и отправляет сообщение 
пользователю с выбором пола (используя инлайн-клавиатуру).
3. warning_not_age: Этот обработчик срабатывает, если введенный возраст является некорректным. 
Он отправляет сообщение пользователю с просьбой ввести корректный возраст или отправить команду 
/cancel для прерывания процесса заполнения формы.
4. process_gender_press: Этот обработчик срабатывает при нажатии кнопки выбора пола у пользователя.
Он сохраняет выбранный пол в хранилище состояния, удаляет сообщение с кнопками и отправляет 
сообщение пользователю с просьбой загрузить фото.
5. warning_not_gender: Этот обработчик срабатывает, если пользователь вводит некорректную команду 
или сообщение вместо использования кнопок выбора пола. Он отправляет сообщение пользователю с 
просьбой использовать кнопки для выбора пола.

Обработчики состояний и формы помогают организовать взаимодействие с пользователями, сохранять 
промежуточные данные и перемещаться по различным этапам формы, обеспечивая удобный 
пользовательский опыт.